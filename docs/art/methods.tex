\section{Methods}\label{art.meth}
We constructed a deterministic compartmental model of heterosexual HIV transmission, stratified by
subpopulations defined by sex and sexual activity, and
health states reflecting HIV natural history and ART cascade of care.
The model includes eight subpopulations,
including FSW at higher \vs lower risk, and likewise for clients of FSW,
and four partnership types, including
main/spousal, casual, repeat sex work, and one-off sex work (Figure~\ref{fig:model.m}).
We calibrated the model to reflect the HIV epidemic and ART scale-up in Eswatini (\emph{base case}).
We then explored \emph{counterfactual} scenarios in which
ART cascade was reduced among various combinations of subpopulations,
and quantified ART prevention impacts by comparing \emph{base case} and \emph{counterfactual} scenarios.
%===================================================================================================
\subsection{Model Parameterization \& Calibration}\label{art.meth.par}
Complete details of the model structure, parameterization, and calibration are given in Appendix~\ref{mod}.
\mf{\input{\app/fig.model}}
\paragraph{HIV}
HIV natural history included acute infection and stages defined by CD4-count.
We modelled relative rates of infectiousness by stage
as an approximation of viral load \cite{Boily2009,Donnell2010,Bellan2015},
as well as rates of HIV-attributable mortality by stage \cite{Mangal2017}.
\paragraph{Risk heterogeneity}
We captured risk heterogeneity through subpopulation-level factors, including
subpopulation size, turnover among subpopulations,
genital ulcer disease (GUD) prevalence, and rates / types of partnership formation;
and partnership-level factors, including
assortative mixing, partnership duration, frequency of sex, and levels of condom use.
Table~\ref{tab:art.het} summarizes key parameter values and sampling distributions related to risk heterogeneity.
To parameterize FSW at higher \vs lower risk, we analyzed individual-level survey data
from Swati FSW in 2011 \cite{Baral2014} and 2014 \cite{EswKP2014} (Appendix~\ref{mod.par.fsw}).
We parameterized the remaining subpopulations using reported data from national studies in
2006 \cite{SDHS2006}, 2011 \cite{SHIMS1}, and 2016 \cite{SHIMS2}.
We modelled
increasing condom use (Figure~\ref{fig:fit.condom}),
increasing voluntary medical male circumcision (Figure~\ref{fig:fit.circum}), and
decreasing GUD prevalence over time,
We did not model other interventions
(\eg current pre-exposure prophylaxis scale-up)
nor non-heterosexual HIV transmission.
\begin{table}
  \centering
  \caption{Selected model parameters related to risk heterogeneity}
  \input{tab.het}
  \label{tab:art.het}
\end{table}
\paragraph{ART cascade}
We modelled rates of HIV diagnosis among people living with HIV as monotonically increasing over time.
We defined a base rate for women with low/medium sexual activity,
and constant relative rates for
men with low/medium sexual activity ($RR < 1$), clients ($RR < 1$), and FSW ($RR > 1$),
reflecting increased HIV testing access via antenatal care among women \vs men,
and enhanced screening among FSW \cite{Baral2014}.
We modelled ART initiation, starting in 2003, similarly except:
the relative rate for ART initiation among FSW was $RR < 1$,
reflecting specific barriers to uptake and engagement in care \cite{Lancaster2016sr}; and
we defined additional relative rates by CD4 count ($RR \le 1$)
to reflect historical ART eligibility criteria (Figure~\ref{fig:art.elig}) \cite{SHIMS2}.
We modelled viral suppression using a fixed rate for all subpopulations,
corresponding to an average of 4 months from ART initiation \cite{Mujugira2016}.
We modelled treatment failure / discontinuation with a single monotonically decreasing rate
applied to all subpopulations in the base case,
reflecting improving treatment success / retention over time \cite{SHIMS2}.
Individuals with treatment failure / discontinuation could re-initiate ART at a fixed rate,
reflecting re-engagement in care or detection of treatment failure and initiation of alternative regimens.
We modelled rapid CD4 recovery during the first 4 months of ART,
followed by slower recovery while virally suppressed \cite{Gabillard2013}.
We modelled reduced HIV-attributable mortality among individuals on ART,
in addition to mortality benefits of CD4 recovery.
\paragraph{Calibration}
We calibrated the model to reflect
available data from Eswatini on HIV prevalence, HIV incidence, and ART cascade of care
overall and stratified by subpopulation where possible
(Tables \ref{tab:targ.prev}--\ref{tab:targ.cascade})
\cite{SDHS2006,SHIMS1,SHIMS2,SHIMS3,Baral2014,EswKP2014,EswIBBS2022}
using an adapted version of Incremental Mixture Importance Sampling (IMIS) \cite{Raftery2010}.
Full methodology is given in Appendix~\ref{mod.cal},
while calibration results are given in Appendix~\ref{sr.cal}.
%===================================================================================================
\subsection{Scenarios \& Analysis}\label{art.meth.obj}
%---------------------------------------------------------------------------------------------------
\subsubsection{Objective~1: Influence of ART cascade differences between subpopulations}\label{art.meth.obj.1}
For Objective~\ref{obj:art.1},
We defined the \emph{base case} scenario to reflect
observed ART cascade scale-up in Eswatini, reaching
\cashi for the population overall by 2020 \cite{SHIMS3}, and
\casfsw among FSW specifically \cite{EswIBBS2022}.%
\footnote{Data on viral suppression for FSW were not available, which we denote as ``xx'';
  no cascade data were available for clients specifically.}
Next, we defined four \emph{counterfactual} scenarios in which
the overall population cascade reached \casmd by 2020,
and where FSW, clients, both, or neither were disproportionately left behind.
In these counterfactual scenarios, we altered cascade attainment among
FSW, clients, and/or the remaining population (``all others'') by calibrating
fixed subpopulation-specific relative rates of:
diagnosis ($0 \le {RR}_d \le 1$),
treatment initiation ($0 \le {RR}_t \le 1$), and
treatment failure / discontinuation ($1 \le {RR}_u \le 20$).
When FSW and/or clients were left behind, we calibrated their $RR$s such that
these subpopulations attained approximately \caslo by 2020, reflecting
some of the lowest cascades recently observed among key populations \cite{Hakim2018}.
By contrast, we calibrated $RR$s for the remaining population such that
the Swati population \emph{overall} attained \casmd in all 4 counterfactual scenarios,
thus ensuring that a consistent proportion of the population overall
attained viral suppression.
\par
Table~\ref{tab:art.1.scen} summarizes these scenarios, while
Figure~\ref{fig:art.1.cascade} plots the modelled cascades over time.
When cascade rates among FSW and/or clients were unchanged from the base case,
the cascade these subpopulations attained could be lower than in the base case
due to subpopulation turnover and higher incidence.
All cascades continued to increase beyond 2020 due to assumed fixed rates of
diagnosis, treatment initiation, and treatment failure / discontinuation thereafter.
\begin{table}
  \centering
  \caption{Modelling scenarios for Objective~\ref{obj:art.1} defined by 2020 calibration targets}
  \label{tab:art.1.scen}
  \input{tab.scenarios}
\end{table}
\par
We quantified ART prevention impacts via relative
cumulative additional infections (CAI) and additional incidence rate (AIR)
in the counterfactual scenarios ($k$) \vs the base case ($0$),
over multiple time horizons up to 2030, starting from $t_0 = 2000$:
\begin{equation}
  \txn{CAI, AIR}\,(t) = \frac{\Omega_{k}(t) - \Omega_{0}(t)}{\Omega_{0}(t)}
  ,\qquad \Omega(t) =
  \begin{cases}
    ~\int_{t_0}^{t}\!\Lambda(\tau)\,d\tau & \txn{CAI} \\
    ~\lambda(t) & \txn{AIR}
  \end{cases}
\end{equation} where:
$\Lambda$ denotes absolute numbers of infections per year, and
$\lambda$ denotes incidence rate per susceptible per year.
For each scenario, we computed these outcomes (CAI and AIR) for each model fit $j$,
and reported median (95\% credible interval, CI) values across model fits, reflecting uncertainty.
%---------------------------------------------------------------------------------------------------
\subsubsection{Objective~2: Conditions that maximize the influence of ART cascade differences}\label{art.meth.obj.2}
For Objective~\ref{obj:art.2}, we estimated via linear regression:
the effects of lower ART cascade among FSW and clients on relative CAI and AIR,
plus potential effect modification by epidemic conditions.
The hypothesized causal effects are illustrated
as a directed acyclic graph in Figure~\ref{fig:art.2.dag}.
\par
For this regression, we generated 10,000 synthetic samples as follows.
We explored a wider range of counterfactual scenarios \vs Objective~\ref{obj:art.1}
by randomly sampling the relative rates for
diagnosis and treatment initiation ${RR}_d, {RR}_t \sim \opname{Beta}(\alpha=3.45,\beta=1.85)$
and treatment failure ${RR}_u \sim \opname{Gamma}(\alpha=3.45,\beta=1.88)$
for each of: FSW, clients, and the remaining population (9~total values).
These sampling distributions had 95\%~CI: (0.25,~0.95) and (1.5,~15), respectively,
and were chosen to obtain cascades in 2020 spanning
approximately \mbox{60-60-90} through \mbox{85-90-95} (Figure~\ref{fig:art.2.cascade}). % MAN
For each of $N_f = 1000$ model fits,
we generated $N_k = 10$ counterfactual scenarios per fit
using Latin hypercube sampling of $RR$s \cite{Stein1987},
yielding $N_f N_k = {}$10,000 total counterfactual samples for the regression.
\par
For each of these 10,000 samples, we defined
relative CAI and AIR by 2030 \vs the base case, as in Objective~\ref{obj:art.1}.
For each sample, we further defined
$U_{fki}$ for subpopulations $i \in \{\tdef{1}{FSW}, \tdef{2}{clients}, \tdef{*}{overall}\}$
as the proportions \emph{not} virally suppressed among those living with HIV by 2020,
reflecting a summary measure of ART cascade gaps.
Using $U_{fki}$, we defined the main regression predictors as:
$D_{fk} = U_{fk*} - U_{f0*} > 0$, reflecting differences in
\emph{population overall} viral non-suppression in sample $k \in [1,10]$
\vs the base case (denoted $k = 0$); and
$d_{fki} = U_{fki} - U_{fk*} \lessgtr 0$, reflecting differences in
\emph{subpopulation-$i$-specific} viral non-suppression in sample $k$
\vs the population overall in sample $k$ --- \ie viral non-suppression inequalities.
\par
Next, we defined the following measures of epidemic conditions ($C_{fj}$) related to sex work,
as hypothesized modifiers of the effect of unequal non-suppression on relative CAI and RAI:
FSW and client population sizes (\% of population overall);
average rate of turnover among FSW and clients (per year, reciprocal of duration selling / buying sex); and
HIV incidence ratios in the year 2020 among FSW \vs other women, and among clients \vs other men.
To calculate the HIV incidence ratios, we combined FSW at higher and lower risk,
and likewise for clients at higher and lower risk.
We used HIV incidence ratios in 2020 to reflect summary measures of risk heterogeneity,
rather than including all risk factors from the transmission model,
which could lead to overfitting and improper inference due to effect mediation.
\par
Finally, we defined a general linear model for each outcome (CAI, AIR) as:
\begin{equation}\label{eq:art.2.glm}
  \txn{CAI, AIR} = \beta_0
                 + \beta_1\,D
                 + \sum_i \beta_i\,d_i
                 + \sum_{ij} \beta_{ij}\,d_i\,C_j
\end{equation}
such that each outcome was modelled as a linear sum of the effects of:
an intercept term;
differential population-level non-suppression in the counterfactual \vs the base scenario ($D$);
differential non-suppression among FSW and clients
\vs the population overall within the counterfactual scenario ($d_i$); and
effect modification of $d_i$ by epidemic conditions ($C_j$).
We fitted this model for each outcome using generalized estimating equations \cite{Hojsgaard2006}
to control for repeated use of each model fit $f$.
We standardized all model variables ($D$, $d_i$, $C_j$) via
$\hat{x} = (x - \txn{mean}(x)) / \txn{SD}(x)$
to avoid issues of different variable scales and collinearity in interaction terms.
Effect sizes can thus be interpreted as
the expected change in outcome per standard deviation change in the variable.%
\footnote{However, regression coefficient magnitudes
  should not be compared to indicate variable ``importance'',
  because the standardization applied to each variable
  is driven by the (arbitrary) variance before standardization.
  For further discussion on interpretation of standardized regression coefficients, see:
  \hreftt{stats.stackexchange.com/questions/29781} and links therein.}
